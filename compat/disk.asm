%include "fcb.h"

;DOS 1.0+ reset disk
;Dosile DSK_RESET
DOS_INT_13:
	MOV AX, CS
	MOV ES, AX
	MOV SI, STUB_STRING
	CALL PRINT
	CALL REGISTER_DUMP
	JMP END_INT

;DOS 1.0+ select disk
;Dosile DSK_SETDEFAULT
DOS_INT_14:
	MOV DX, REGISTER_DX
	CALL DOSILE_GET_BPB
	CALL DOSILE_INIT_DISK
	CALL DOSILE_LOADFAT
	CALL DOSILE_LOADROOT
	JMP END_INT

;DOS 1.0+ open file using FCB
DOS_INT_15:
	PUSH WORD [DRIVE_NUM]
	MOV SI, REGISTER_DX
	MOV ES, REGISTER_DS
	MOV DL, BYTE [ES:SI + FCB_DRIVE]
	MOV AH, DSK_SETDEFAULT
	INT SYS_DOS
	INC SI
	MOV DI, SI
	CALL DOSILE_FINDFILE
	CLI
	HLT
	JMP END_INT
